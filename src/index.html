<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Professional 3D Floor Plan Editor</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/main.css">
</head>
<body>
  <!-- Toolbar -->
  <div id="toolbar">
    <div class="toolbar-group">
      <button id="theme-toggle" title="Toggle Theme">☀️</button>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="view-toggle" title="Toggle 2D/3D View">2D</button>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="tool-wall" class="active" title="Draw Walls (W)">Wall</button>
      <button id="tool-rect" title="Draw Rectangle Room (R)">Rect</button>
      <button id="tool-select" title="Select (V)">Select</button>
      <button id="tool-dimension" title="Add Dimension (D)">Dimension</button>
      <button id="tool-annotate" title="Add Annotation (A)">Annotate</button>
      <button id="tool-shape" title="Draw Shape (S)">Shape</button>
      <button id="tool-wire" title="Draw Wiring (E)">Wire</button>
      <select id="wire-type" style="padding: 6px 8px; font-size: 12px;">
        <option value="electrical">Electrical</option>
        <option value="data">Data/Network</option>
        <option value="speaker">Speaker</option>
        <option value="low-voltage">Low Voltage</option>
        <option value="conduit">Conduit</option>
      </select>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group" style="display: flex; align-items: center; gap: 8px;">
      <span style="font-size: 12px; color: var(--text-secondary);">Grid:</span>
      <input type="number" id="grid-size" min="0" max="120" value="6" style="width: 50px; background: var(--bg-tertiary); border: 1px solid var(--border); color: var(--text-primary); padding: 4px 6px; border-radius: 3px; font-size: 12px;">
      <span style="font-size: 12px; color: var(--text-secondary);">in</span>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="btn-undo" title="Undo (Ctrl+Z)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 10h10a5 5 0 0 1 5 5v2"/>
          <polyline points="3 10 8 5 3 10 8 15"/>
        </svg>
      </button>
      <button id="btn-redo" title="Redo (Ctrl+Y)">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 10H11a5 5 0 0 0-5 5v2"/>
          <polyline points="21 10 16 5 21 10 16 15"/>
        </svg>
      </button>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="btn-save" title="Save Project">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
          <polyline points="17 21 17 13 7 13 7 21"/>
          <polyline points="7 3 7 8 15 8"/>
        </svg>
      </button>
      <button id="btn-load" title="Load Project">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
          <line x1="12" y1="11" x2="12" y2="17"/>
          <polyline points="9 14 12 11 15 14"/>
        </svg>
      </button>
      <input type="file" id="load-input" accept=".json,.floorplan" style="display: none;">
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="btn-complete" title="Complete Floor Plan">Complete</button>
      <button id="btn-clear" title="Clear All">Clear</button>
    </div>
    <div class="toolbar-divider"></div>
    <div class="toolbar-group">
      <button id="btn-import-image" title="Import Reference Image">Import Image</button>
      <button id="btn-set-scale" title="Set Scale Reference" disabled>Set Scale</button>
      <input type="file" id="image-input" accept="image/*" style="display: none;">
    </div>
  </div>

  <!-- Main Container -->
  <div id="main-container">
    <!-- Symbol Library - Redesigned -->
    <div id="symbol-library">
      <div class="resize-handle resize-handle-right" data-resize="symbol-library"></div>
      <div class="library-header">
        <h2>Objects Library</h2>
        <div class="library-tabs">
          <button class="library-tab active" data-tab="residential">Residential</button>
          <button class="library-tab" data-tab="workshop">Workshop</button>
        </div>
      </div>

      <!-- Openings Section (Always Visible) -->
      <div class="openings-section">
        <h3>Doors & Windows</h3>
        <div class="symbol-grid">
          <div class="symbol-item" data-symbol="door-single" draggable="true" title="Single Door">
            <svg viewBox="0 0 40 40">
              <rect x="5" y="5" width="30" height="4" fill="var(--opening-door)"/>
              <path d="M5 9 Q5 35, 35 35" stroke="var(--opening-door)" fill="none" stroke-width="1"/>
            </svg>
            <span>Door</span>
          </div>
          <div class="symbol-item" data-symbol="door-double" draggable="true" title="Double Door">
            <svg viewBox="0 0 40 40">
              <rect x="2" y="5" width="36" height="4" fill="var(--opening-door)"/>
              <path d="M2 9 Q2 30, 20 30" stroke="var(--opening-door)" fill="none" stroke-width="1"/>
              <path d="M38 9 Q38 30, 20 30" stroke="var(--opening-door)" fill="none" stroke-width="1"/>
            </svg>
            <span>Double</span>
          </div>
          <div class="symbol-item" data-symbol="door-sliding" draggable="true" title="Sliding Door">
            <svg viewBox="0 0 40 40">
              <rect x="2" y="16" width="18" height="4" fill="var(--opening-door)"/>
              <rect x="20" y="20" width="18" height="4" fill="var(--opening-door)" opacity="0.6"/>
            </svg>
            <span>Sliding</span>
          </div>
          <div class="symbol-item" data-symbol="window-single" draggable="true" title="Window">
            <svg viewBox="0 0 40 40">
              <rect x="8" y="15" width="24" height="6" fill="var(--opening-window)" stroke="var(--wall-color)" stroke-width="2"/>
            </svg>
            <span>Window</span>
          </div>
          <div class="symbol-item" data-symbol="window-double" draggable="true" title="Double Window">
            <svg viewBox="0 0 40 40">
              <rect x="4" y="15" width="14" height="6" fill="var(--opening-window)" stroke="var(--wall-color)" stroke-width="2"/>
              <rect x="22" y="15" width="14" height="6" fill="var(--opening-window)" stroke="var(--wall-color)" stroke-width="2"/>
            </svg>
            <span>Dbl Window</span>
          </div>
          <div class="symbol-item" data-symbol="window-bay" draggable="true" title="Bay Window">
            <svg viewBox="0 0 40 40">
              <path d="M5 25 L15 15 L25 15 L35 25" fill="none" stroke="var(--opening-window)" stroke-width="3"/>
              <rect x="15" y="12" width="10" height="6" fill="var(--opening-window)"/>
            </svg>
            <span>Bay</span>
          </div>
        </div>
      </div>

      <!-- Residential Content -->
      <div class="library-content" id="tab-residential">
        <!-- Living Room -->
        <div class="library-category">
          <div class="category-header open" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="8" width="18" height="12" rx="2"/><path d="M7 8V6a2 2 0 012-2h6a2 2 0 012 2v2"/></svg>
              Living Room
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content open">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="sofa" draggable="true" title="Sofa">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="14" width="32" height="18" fill="var(--furniture-color)" rx="3"/>
                  <rect x="6" y="10" width="8" height="6" fill="var(--furniture-color)" rx="2"/>
                  <rect x="26" y="10" width="8" height="6" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Sofa</span>
              </div>
              <div class="symbol-item" data-symbol="sofa-l" draggable="true" title="L-Shaped Sofa">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="4" width="32" height="14" fill="var(--furniture-color)" rx="2"/>
                  <rect x="4" y="18" width="14" height="18" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>L-Sofa</span>
              </div>
              <div class="symbol-item" data-symbol="armchair" draggable="true" title="Armchair">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="12" width="24" height="20" fill="var(--furniture-color)" rx="3"/>
                  <rect x="10" y="8" width="6" height="6" fill="var(--furniture-color)" rx="2"/>
                  <rect x="24" y="8" width="6" height="6" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Armchair</span>
              </div>
              <div class="symbol-item" data-symbol="coffee-table" draggable="true" title="Coffee Table">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="12" width="28" height="16" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Coffee Tbl</span>
              </div>
              <div class="symbol-item" data-symbol="tv-stand" draggable="true" title="TV Stand">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="20" width="32" height="12" fill="var(--furniture-color)" rx="1"/>
                  <rect x="10" y="8" width="20" height="12" fill="var(--bg-tertiary)" stroke="var(--furniture-color)" stroke-width="2"/>
                </svg>
                <span>TV Stand</span>
              </div>
              <div class="symbol-item" data-symbol="bookshelf" draggable="true" title="Bookshelf">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="4" width="28" height="32" fill="none" stroke="var(--furniture-color)" stroke-width="2"/>
                  <line x1="6" y1="14" x2="34" y2="14" stroke="var(--furniture-color)" stroke-width="2"/>
                  <line x1="6" y1="24" x2="34" y2="24" stroke="var(--furniture-color)" stroke-width="2"/>
                </svg>
                <span>Bookshelf</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Bedroom -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 12h20v8H2z"/><path d="M2 12V8a2 2 0 012-2h16a2 2 0 012 2v4"/><path d="M6 12V8"/><path d="M18 12V8"/></svg>
              Bedroom
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="bed-single" draggable="true" title="Single Bed">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="4" width="24" height="32" fill="var(--furniture-color)" rx="2"/>
                  <rect x="10" y="6" width="20" height="8" fill="var(--bg-tertiary)" rx="1"/>
                </svg>
                <span>Single Bed</span>
              </div>
              <div class="symbol-item" data-symbol="bed-double" draggable="true" title="Double Bed">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="4" width="32" height="32" fill="var(--furniture-color)" rx="2"/>
                  <rect x="6" y="6" width="12" height="8" fill="var(--bg-tertiary)" rx="1"/>
                  <rect x="22" y="6" width="12" height="8" fill="var(--bg-tertiary)" rx="1"/>
                </svg>
                <span>Double Bed</span>
              </div>
              <div class="symbol-item" data-symbol="bed-king" draggable="true" title="King Bed">
                <svg viewBox="0 0 40 40">
                  <rect x="2" y="4" width="36" height="32" fill="var(--furniture-color)" rx="2"/>
                  <rect x="4" y="6" width="14" height="8" fill="var(--bg-tertiary)" rx="1"/>
                  <rect x="22" y="6" width="14" height="8" fill="var(--bg-tertiary)" rx="1"/>
                </svg>
                <span>King Bed</span>
              </div>
              <div class="symbol-item" data-symbol="nightstand" draggable="true" title="Nightstand">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="10" width="20" height="20" fill="var(--furniture-color)" rx="2"/>
                  <line x1="10" y1="20" x2="30" y2="20" stroke="var(--bg-tertiary)" stroke-width="2"/>
                </svg>
                <span>Nightstand</span>
              </div>
              <div class="symbol-item" data-symbol="dresser" draggable="true" title="Dresser">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="8" width="32" height="24" fill="var(--furniture-color)" rx="2"/>
                  <line x1="4" y1="16" x2="36" y2="16" stroke="var(--bg-tertiary)" stroke-width="2"/>
                  <line x1="4" y1="24" x2="36" y2="24" stroke="var(--bg-tertiary)" stroke-width="2"/>
                </svg>
                <span>Dresser</span>
              </div>
              <div class="symbol-item" data-symbol="wardrobe" draggable="true" title="Wardrobe">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="4" width="28" height="32" fill="var(--furniture-color)" rx="2"/>
                  <line x1="20" y1="4" x2="20" y2="36" stroke="var(--bg-tertiary)" stroke-width="2"/>
                </svg>
                <span>Wardrobe</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Kitchen -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
              Kitchen
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="counter" draggable="true" title="Counter">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="14" width="32" height="18" fill="var(--furniture-color)" rx="1"/>
                </svg>
                <span>Counter</span>
              </div>
              <div class="symbol-item" data-symbol="sink" draggable="true" title="Kitchen Sink">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="10" width="28" height="20" fill="var(--furniture-color)" rx="2"/>
                  <ellipse cx="20" cy="20" rx="8" ry="6" fill="var(--bg-tertiary)"/>
                </svg>
                <span>Sink</span>
              </div>
              <div class="symbol-item" data-symbol="stove" draggable="true" title="Stove">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="6" width="28" height="28" fill="var(--furniture-color)" rx="2"/>
                  <circle cx="14" cy="14" r="4" fill="var(--bg-tertiary)"/>
                  <circle cx="26" cy="14" r="4" fill="var(--bg-tertiary)"/>
                  <circle cx="14" cy="26" r="4" fill="var(--bg-tertiary)"/>
                  <circle cx="26" cy="26" r="4" fill="var(--bg-tertiary)"/>
                </svg>
                <span>Stove</span>
              </div>
              <div class="symbol-item" data-symbol="fridge" draggable="true" title="Refrigerator">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="2" width="24" height="36" fill="var(--furniture-color)" rx="2"/>
                  <line x1="8" y1="14" x2="32" y2="14" stroke="var(--bg-tertiary)" stroke-width="2"/>
                </svg>
                <span>Fridge</span>
              </div>
              <div class="symbol-item" data-symbol="dishwasher" draggable="true" title="Dishwasher">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="8" width="24" height="24" fill="var(--furniture-color)" rx="2"/>
                  <rect x="12" y="12" width="16" height="4" fill="var(--bg-tertiary)" rx="1"/>
                </svg>
                <span>Dishwasher</span>
              </div>
              <div class="symbol-item" data-symbol="island" draggable="true" title="Kitchen Island">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="10" width="32" height="20" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Island</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Bathroom -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 12h16v5a3 3 0 01-3 3H7a3 3 0 01-3-3v-5z"/><path d="M6 12V5a2 2 0 012-2h1"/><circle cx="9" cy="5" r="1"/></svg>
              Bathroom
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="toilet" draggable="true" title="Toilet">
                <svg viewBox="0 0 40 40">
                  <ellipse cx="20" cy="24" rx="10" ry="12" fill="white" stroke="var(--border)"/>
                  <rect x="12" y="6" width="16" height="10" fill="white" stroke="var(--border)" rx="2"/>
                </svg>
                <span>Toilet</span>
              </div>
              <div class="symbol-item" data-symbol="bathtub" draggable="true" title="Bathtub">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="8" width="32" height="24" fill="white" stroke="var(--border)" stroke-width="2" rx="4"/>
                  <circle cx="10" cy="16" r="2" fill="var(--border)"/>
                </svg>
                <span>Bathtub</span>
              </div>
              <div class="symbol-item" data-symbol="shower" draggable="true" title="Shower">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="6" width="28" height="28" fill="white" stroke="var(--border)" stroke-width="2"/>
                  <circle cx="28" cy="12" r="3" fill="var(--border)"/>
                </svg>
                <span>Shower</span>
              </div>
              <div class="symbol-item" data-symbol="vanity" draggable="true" title="Vanity">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="16" width="32" height="16" fill="var(--furniture-color)" rx="2"/>
                  <ellipse cx="20" cy="22" rx="8" ry="5" fill="white" stroke="var(--border)"/>
                </svg>
                <span>Vanity</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Dining -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="8" width="18" height="12" rx="1"/><path d="M12 8V5"/><path d="M6 8V5"/><path d="M18 8V5"/></svg>
              Dining
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="dining-table-rect" draggable="true" title="Dining Table">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="10" width="28" height="20" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Rect Table</span>
              </div>
              <div class="symbol-item" data-symbol="dining-table-round" draggable="true" title="Round Dining Table">
                <svg viewBox="0 0 40 40">
                  <circle cx="20" cy="20" r="14" fill="var(--furniture-color)"/>
                </svg>
                <span>Round Table</span>
              </div>
              <div class="symbol-item" data-symbol="chair" draggable="true" title="Dining Chair">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="20" width="20" height="16" fill="var(--furniture-color)" rx="2"/>
                  <rect x="12" y="8" width="16" height="10" fill="var(--furniture-color)" rx="2"/>
                </svg>
                <span>Chair</span>
              </div>
              <div class="symbol-item" data-symbol="bar-stool" draggable="true" title="Bar Stool">
                <svg viewBox="0 0 40 40">
                  <circle cx="20" cy="16" r="8" fill="var(--furniture-color)"/>
                  <rect x="18" y="24" width="4" height="10" fill="#6b7280"/>
                  <ellipse cx="20" cy="36" rx="8" ry="2" fill="#6b7280"/>
                </svg>
                <span>Bar Stool</span>
              </div>
              <div class="symbol-item" data-symbol="counter-stool" draggable="true" title="Counter Stool">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="14" width="20" height="6" fill="var(--furniture-color)" rx="2"/>
                  <rect x="12" y="6" width="16" height="8" fill="var(--furniture-color)" rx="2"/>
                  <rect x="12" y="20" width="4" height="14" fill="#6b7280"/>
                  <rect x="24" y="20" width="4" height="14" fill="#6b7280"/>
                </svg>
                <span>Counter Stool</span>
              </div>
              <div class="symbol-item" data-symbol="buffet" draggable="true" title="Buffet">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="14" width="32" height="16" fill="var(--furniture-color)" rx="2"/>
                  <line x1="14" y1="14" x2="14" y2="30" stroke="var(--bg-tertiary)" stroke-width="2"/>
                  <line x1="26" y1="14" x2="26" y2="30" stroke="var(--bg-tertiary)" stroke-width="2"/>
                </svg>
                <span>Buffet</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Workshop Content -->
      <div class="library-content" id="tab-workshop" style="display: none;">
        <!-- Machinery -->
        <div class="library-category">
          <div class="category-header open" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/></svg>
              Machinery
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content open">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="lathe" draggable="true" title="Lathe">
                <svg viewBox="0 0 40 40">
                  <rect x="2" y="14" width="36" height="16" fill="#6b7280" rx="2"/>
                  <rect x="4" y="10" width="8" height="8" fill="#9ca3af" rx="1"/>
                  <circle cx="8" cy="14" r="4" fill="#4b5563"/>
                  <rect x="30" y="16" width="6" height="12" fill="#9ca3af"/>
                </svg>
                <span>Lathe</span>
              </div>
              <div class="symbol-item" data-symbol="mill" draggable="true" title="Milling Machine">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="20" width="24" height="16" fill="#6b7280" rx="2"/>
                  <rect x="12" y="6" width="16" height="14" fill="#9ca3af" rx="1"/>
                  <rect x="18" y="2" width="4" height="8" fill="#4b5563"/>
                </svg>
                <span>Mill</span>
              </div>
              <div class="symbol-item" data-symbol="drill-press" draggable="true" title="Drill Press">
                <svg viewBox="0 0 40 40">
                  <rect x="14" y="28" width="12" height="8" fill="#6b7280" rx="1"/>
                  <rect x="16" y="8" width="8" height="20" fill="#9ca3af"/>
                  <rect x="18" y="4" width="4" height="6" fill="#4b5563"/>
                  <circle cx="20" cy="32" r="4" fill="#4b5563"/>
                </svg>
                <span>Drill Press</span>
              </div>
              <div class="symbol-item" data-symbol="bandsaw" draggable="true" title="Bandsaw">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="22" width="24" height="14" fill="#6b7280" rx="2"/>
                  <circle cx="20" cy="12" r="8" fill="none" stroke="#9ca3af" stroke-width="3"/>
                  <line x1="20" y1="20" x2="20" y2="36" stroke="#ef4444" stroke-width="1"/>
                </svg>
                <span>Bandsaw</span>
              </div>
              <div class="symbol-item" data-symbol="table-saw" draggable="true" title="Table Saw">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="12" width="32" height="20" fill="#6b7280" rx="2"/>
                  <circle cx="20" cy="22" r="8" fill="#4b5563"/>
                  <line x1="20" y1="14" x2="20" y2="30" stroke="#ef4444" stroke-width="2"/>
                </svg>
                <span>Table Saw</span>
              </div>
              <div class="symbol-item" data-symbol="grinder" draggable="true" title="Bench Grinder">
                <svg viewBox="0 0 40 40">
                  <rect x="12" y="24" width="16" height="10" fill="#6b7280" rx="1"/>
                  <circle cx="10" cy="18" r="6" fill="#9ca3af"/>
                  <circle cx="30" cy="18" r="6" fill="#9ca3af"/>
                </svg>
                <span>Grinder</span>
              </div>
              <div class="symbol-item" data-symbol="cnc-router" draggable="true" title="CNC Router">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="8" width="32" height="24" fill="#6b7280" rx="2"/>
                  <rect x="8" y="12" width="24" height="16" fill="#4b5563" rx="1"/>
                  <rect x="16" y="10" width="8" height="4" fill="#9ca3af"/>
                </svg>
                <span>CNC Router</span>
              </div>
              <div class="symbol-item" data-symbol="welder" draggable="true" title="Welding Station">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="16" width="20" height="18" fill="#6b7280" rx="2"/>
                  <rect x="14" y="8" width="12" height="8" fill="#9ca3af" rx="1"/>
                  <circle cx="20" cy="12" r="2" fill="#fbbf24"/>
                </svg>
                <span>Welder</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Work Surfaces -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="1"/><path d="M4 18v2"/><path d="M20 18v2"/></svg>
              Work Surfaces
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="workbench" draggable="true" title="Workbench">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="12" width="32" height="6" fill="#92400e"/>
                  <rect x="6" y="18" width="4" height="16" fill="#78350f"/>
                  <rect x="30" y="18" width="4" height="16" fill="#78350f"/>
                </svg>
                <span>Workbench</span>
              </div>
              <div class="symbol-item" data-symbol="assembly-table" draggable="true" title="Assembly Table">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="10" width="32" height="4" fill="#6b7280"/>
                  <rect x="6" y="14" width="4" height="20" fill="#4b5563"/>
                  <rect x="30" y="14" width="4" height="20" fill="#4b5563"/>
                </svg>
                <span>Assembly Tbl</span>
              </div>
              <div class="symbol-item" data-symbol="welding-table" draggable="true" title="Welding Table">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="12" width="28" height="4" fill="#6b7280"/>
                  <rect x="6" y="16" width="28" height="16" fill="#4b5563"/>
                  <line x1="12" y1="16" x2="12" y2="32" stroke="#374151" stroke-width="1"/>
                  <line x1="20" y1="16" x2="20" y2="32" stroke="#374151" stroke-width="1"/>
                  <line x1="28" y1="16" x2="28" y2="32" stroke="#374151" stroke-width="1"/>
                </svg>
                <span>Weld Table</span>
              </div>
              <div class="symbol-item" data-symbol="outfeed-table" draggable="true" title="Outfeed Table">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="14" width="24" height="4" fill="#9ca3af"/>
                  <rect x="10" y="18" width="4" height="14" fill="#6b7280"/>
                  <rect x="26" y="18" width="4" height="14" fill="#6b7280"/>
                  <line x1="8" y1="16" x2="32" y2="16" stroke="#6b7280" stroke-width="1" stroke-dasharray="2"/>
                </svg>
                <span>Outfeed</span>
              </div>
              <div class="symbol-item" data-symbol="packing-table" draggable="true" title="Packing Table">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="14" width="32" height="4" fill="#92400e"/>
                  <rect x="6" y="18" width="4" height="14" fill="#78350f"/>
                  <rect x="30" y="18" width="4" height="14" fill="#78350f"/>
                  <rect x="14" y="8" width="12" height="6" fill="none" stroke="#d97706" stroke-width="1"/>
                </svg>
                <span>Packing Tbl</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Storage -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M3 15h18"/></svg>
              Storage
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="tool-chest" draggable="true" title="Tool Chest">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="8" width="28" height="26" fill="#dc2626" rx="2"/>
                  <line x1="6" y1="14" x2="34" y2="14" stroke="#991b1b" stroke-width="1"/>
                  <line x1="6" y1="20" x2="34" y2="20" stroke="#991b1b" stroke-width="1"/>
                  <line x1="6" y1="26" x2="34" y2="26" stroke="#991b1b" stroke-width="1"/>
                </svg>
                <span>Tool Chest</span>
              </div>
              <div class="symbol-item" data-symbol="shelving" draggable="true" title="Shelving Unit">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="4" width="28" height="32" fill="none" stroke="#6b7280" stroke-width="2"/>
                  <line x1="6" y1="12" x2="34" y2="12" stroke="#6b7280" stroke-width="2"/>
                  <line x1="6" y1="20" x2="34" y2="20" stroke="#6b7280" stroke-width="2"/>
                  <line x1="6" y1="28" x2="34" y2="28" stroke="#6b7280" stroke-width="2"/>
                </svg>
                <span>Shelving</span>
              </div>
              <div class="symbol-item" data-symbol="cabinet" draggable="true" title="Storage Cabinet">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="4" width="28" height="32" fill="#6b7280" rx="2"/>
                  <line x1="20" y1="4" x2="20" y2="36" stroke="#4b5563" stroke-width="2"/>
                  <circle cx="17" cy="20" r="1" fill="#9ca3af"/>
                  <circle cx="23" cy="20" r="1" fill="#9ca3af"/>
                </svg>
                <span>Cabinet</span>
              </div>
              <div class="symbol-item" data-symbol="pallet-rack" draggable="true" title="Pallet Rack">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="4" width="4" height="32" fill="#f59e0b"/>
                  <rect x="32" y="4" width="4" height="32" fill="#f59e0b"/>
                  <rect x="4" y="12" width="32" height="3" fill="#fbbf24"/>
                  <rect x="4" y="24" width="32" height="3" fill="#fbbf24"/>
                </svg>
                <span>Pallet Rack</span>
              </div>
              <div class="symbol-item" data-symbol="bin-rack" draggable="true" title="Parts Bin Rack">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="6" width="28" height="28" fill="#6b7280" rx="1"/>
                  <rect x="8" y="8" width="6" height="6" fill="#3b82f6"/>
                  <rect x="17" y="8" width="6" height="6" fill="#ef4444"/>
                  <rect x="26" y="8" width="6" height="6" fill="#22c55e"/>
                  <rect x="8" y="17" width="6" height="6" fill="#fbbf24"/>
                  <rect x="17" y="17" width="6" height="6" fill="#8b5cf6"/>
                  <rect x="26" y="17" width="6" height="6" fill="#ec4899"/>
                </svg>
                <span>Bin Rack</span>
              </div>
              <div class="symbol-item" data-symbol="lumber-rack" draggable="true" title="Lumber Rack">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="8" width="4" height="28" fill="#f59e0b"/>
                  <rect x="32" y="8" width="4" height="28" fill="#f59e0b"/>
                  <rect x="8" y="12" width="24" height="3" fill="#92400e"/>
                  <rect x="8" y="20" width="24" height="3" fill="#92400e"/>
                  <rect x="8" y="28" width="24" height="3" fill="#92400e"/>
                </svg>
                <span>Lumber Rack</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Equipment -->
        <div class="library-category">
          <div class="category-header" onclick="toggleCategory(this)">
            <h3>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
              Equipment
            </h3>
            <svg class="category-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="category-content">
            <div class="symbol-grid">
              <div class="symbol-item" data-symbol="air-compressor" draggable="true" title="Air Compressor">
                <svg viewBox="0 0 40 40">
                  <ellipse cx="20" cy="24" rx="14" ry="10" fill="#6b7280"/>
                  <rect x="14" y="10" width="12" height="10" fill="#9ca3af" rx="1"/>
                  <circle cx="20" cy="24" r="4" fill="#4b5563"/>
                </svg>
                <span>Compressor</span>
              </div>
              <div class="symbol-item" data-symbol="dust-collector" draggable="true" title="Dust Collector">
                <svg viewBox="0 0 40 40">
                  <circle cx="20" cy="24" r="12" fill="#6b7280"/>
                  <rect x="16" y="4" width="8" height="12" fill="#9ca3af"/>
                  <circle cx="20" cy="24" r="6" fill="#4b5563"/>
                </svg>
                <span>Dust Collect</span>
              </div>
              <div class="symbol-item" data-symbol="vise" draggable="true" title="Bench Vise">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="18" width="24" height="12" fill="#6b7280" rx="1"/>
                  <rect x="4" y="20" width="6" height="8" fill="#9ca3af"/>
                  <rect x="30" y="20" width="6" height="8" fill="#9ca3af"/>
                </svg>
                <span>Vise</span>
              </div>
              <div class="symbol-item" data-symbol="hydraulic-press" draggable="true" title="Hydraulic Press">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="4" width="24" height="32" fill="#6b7280" rx="2"/>
                  <rect x="4" y="8" width="4" height="24" fill="#4b5563"/>
                  <rect x="32" y="8" width="4" height="24" fill="#4b5563"/>
                  <rect x="12" y="16" width="16" height="4" fill="#ef4444"/>
                </svg>
                <span>Press</span>
              </div>
              <div class="symbol-item" data-symbol="forklift" draggable="true" title="Forklift Parking">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="12" width="18" height="16" fill="#fbbf24" rx="2"/>
                  <rect x="6" y="20" width="4" height="12" fill="#6b7280"/>
                  <circle cx="14" cy="30" r="3" fill="#4b5563"/>
                  <circle cx="24" cy="30" r="3" fill="#4b5563"/>
                </svg>
                <span>Forklift</span>
              </div>
              <div class="symbol-item" data-symbol="hand-truck" draggable="true" title="Hand Truck Station">
                <svg viewBox="0 0 40 40">
                  <rect x="16" y="6" width="8" height="22" fill="#6b7280" rx="1"/>
                  <circle cx="14" cy="32" r="4" fill="#4b5563"/>
                  <circle cx="26" cy="32" r="4" fill="#4b5563"/>
                </svg>
                <span>Hand Truck</span>
              </div>
              <div class="symbol-item" data-symbol="waterjet" draggable="true" title="Waterjet/Hydrocutter">
                <svg viewBox="0 0 40 40">
                  <rect x="4" y="8" width="32" height="24" fill="#6b7280" rx="2"/>
                  <rect x="8" y="12" width="24" height="16" fill="#1e3a5f"/>
                  <path d="M20 16 L20 24" stroke="#3b82f6" stroke-width="3" stroke-linecap="round"/>
                  <circle cx="20" cy="14" r="3" fill="#60a5fa"/>
                </svg>
                <span>Waterjet</span>
              </div>
              <div class="symbol-item" data-symbol="sandblaster" draggable="true" title="Sandblaster Cabinet">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="6" width="28" height="24" fill="#6b7280" rx="2"/>
                  <rect x="10" y="10" width="20" height="12" fill="#4b5563" rx="1"/>
                  <circle cx="14" cy="16" r="3" fill="#fbbf24" opacity="0.7"/>
                  <circle cx="20" cy="16" r="2" fill="#fbbf24" opacity="0.5"/>
                  <circle cx="26" cy="16" r="2.5" fill="#fbbf24" opacity="0.6"/>
                  <rect x="12" y="30" width="6" height="4" fill="#4b5563"/>
                  <rect x="22" y="30" width="6" height="4" fill="#4b5563"/>
                </svg>
                <span>Sandblaster</span>
              </div>
              <div class="symbol-item" data-symbol="air-manifold" draggable="true" title="Compressed Air Manifold">
                <svg viewBox="0 0 40 40">
                  <rect x="14" y="6" width="12" height="28" fill="#3b82f6" rx="2"/>
                  <rect x="6" y="12" width="8" height="4" fill="#60a5fa"/>
                  <rect x="26" y="12" width="8" height="4" fill="#60a5fa"/>
                  <rect x="6" y="20" width="8" height="4" fill="#60a5fa"/>
                  <rect x="26" y="20" width="8" height="4" fill="#60a5fa"/>
                  <rect x="6" y="28" width="8" height="4" fill="#60a5fa"/>
                  <rect x="26" y="28" width="8" height="4" fill="#60a5fa"/>
                  <circle cx="20" cy="10" r="2" fill="#1e3a5f"/>
                </svg>
                <span>Air Manifold</span>
              </div>
              <div class="symbol-item" data-symbol="shop-sink" draggable="true" title="Shop Sink">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="12" width="28" height="22" fill="#4b5563" rx="2"/>
                  <rect x="10" y="16" width="20" height="14" fill="#c0c0c0" rx="1"/>
                  <ellipse cx="20" cy="23" rx="6" ry="4" fill="#6b7280"/>
                  <rect x="18" y="6" width="4" height="6" fill="#c0c0c0"/>
                  <circle cx="20" cy="8" r="2" fill="#9ca3af"/>
                </svg>
                <span>Shop Sink</span>
              </div>
              <div class="symbol-item" data-symbol="hot-water-heater" draggable="true" title="Hot Water Heater">
                <svg viewBox="0 0 40 40">
                  <ellipse cx="20" cy="6" rx="10" ry="4" fill="#e5e7eb"/>
                  <rect x="10" y="6" width="20" height="28" fill="#f5f5f5"/>
                  <ellipse cx="20" cy="34" rx="10" ry="4" fill="#d1d5db"/>
                  <rect x="14" y="2" width="3" height="6" fill="#cd7f32"/>
                  <rect x="23" y="2" width="3" height="6" fill="#cd7f32"/>
                  <rect x="16" y="18" width="8" height="4" fill="#1a1a1a" rx="1"/>
                  <circle cx="18" cy="20" r="1" fill="#00ff00"/>
                </svg>
                <span>Water Heater</span>
              </div>
              <div class="symbol-item" data-symbol="motorcycle" draggable="true" title="Royal Enfield Continental GT 650">
                <svg viewBox="0 0 40 40">
                  <circle cx="8" cy="28" r="6" fill="none" stroke="#1a1a1a" stroke-width="2"/>
                  <circle cx="32" cy="28" r="6" fill="none" stroke="#1a1a1a" stroke-width="2"/>
                  <path d="M8 28 L14 20 L26 18 L32 28" fill="none" stroke="#1a1a1a" stroke-width="2"/>
                  <ellipse cx="20" cy="16" rx="8" ry="4" fill="#8B0000"/>
                  <rect x="16" y="18" width="10" height="4" fill="#3d2314" rx="1"/>
                  <circle cx="30" cy="14" r="3" fill="#ffffcc" stroke="#d4d4d4"/>
                  <rect x="5" y="14" width="6" height="3" fill="#d4d4d4"/>
                </svg>
                <span>Motorcycle</span>
              </div>
              <div class="symbol-item" data-symbol="office-chair" draggable="true" title="Office Chair">
                <svg viewBox="0 0 40 40">
                  <ellipse cx="20" cy="34" rx="10" ry="3" fill="#4b5563"/>
                  <rect x="18" y="22" width="4" height="12" fill="#4b5563"/>
                  <rect x="8" y="14" width="24" height="8" fill="#1f2937" rx="2"/>
                  <rect x="10" y="4" width="20" height="10" fill="#1f2937" rx="2"/>
                  <rect x="4" y="16" width="6" height="3" fill="#4b5563"/>
                  <rect x="30" y="16" width="6" height="3" fill="#4b5563"/>
                </svg>
                <span>Office Chair</span>
              </div>

              <!-- Electrical Items -->
              <div class="symbol-item" data-symbol="electrical-panel" draggable="true" title="Electrical Panel / Fuse Box">
                <svg viewBox="0 0 40 40">
                  <rect x="6" y="4" width="28" height="32" fill="#4b5563" rx="2"/>
                  <rect x="8" y="6" width="24" height="28" fill="#374151"/>
                  <rect x="10" y="8" width="8" height="4" fill="#1f2937"/>
                  <rect x="22" y="8" width="8" height="4" fill="#1f2937"/>
                  <rect x="10" y="14" width="8" height="4" fill="#1f2937"/>
                  <rect x="22" y="14" width="8" height="4" fill="#1f2937"/>
                  <rect x="10" y="20" width="8" height="4" fill="#1f2937"/>
                  <rect x="22" y="20" width="8" height="4" fill="#1f2937"/>
                  <rect x="10" y="26" width="8" height="4" fill="#ef4444"/>
                  <rect x="22" y="26" width="8" height="4" fill="#ef4444"/>
                </svg>
                <span>Electrical Panel</span>
              </div>
              <div class="symbol-item" data-symbol="junction-box" draggable="true" title="Junction Box">
                <svg viewBox="0 0 40 40">
                  <rect x="8" y="8" width="24" height="24" fill="#6b7280" rx="2"/>
                  <rect x="10" y="10" width="20" height="20" fill="#4b5563"/>
                  <circle cx="16" cy="16" r="2" fill="#9ca3af"/>
                  <circle cx="24" cy="16" r="2" fill="#9ca3af"/>
                  <circle cx="16" cy="24" r="2" fill="#9ca3af"/>
                  <circle cx="24" cy="24" r="2" fill="#9ca3af"/>
                  <rect x="14" y="0" width="4" height="10" fill="#ffcc00"/>
                  <rect x="22" y="0" width="4" height="10" fill="#ffcc00"/>
                  <rect x="14" y="30" width="4" height="10" fill="#ffcc00"/>
                  <rect x="22" y="30" width="4" height="10" fill="#ffcc00"/>
                </svg>
                <span>Junction Box</span>
              </div>
              <div class="symbol-item" data-symbol="outlet" draggable="true" title="Electrical Outlet">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="8" width="20" height="24" fill="#f5f5f5" rx="2"/>
                  <rect x="12" y="10" width="16" height="20" fill="#e5e7eb"/>
                  <rect x="15" y="14" width="4" height="6" rx="1" fill="#1f2937"/>
                  <rect x="21" y="14" width="4" height="6" rx="1" fill="#1f2937"/>
                  <circle cx="20" cy="24" r="2" fill="#1f2937"/>
                </svg>
                <span>Outlet</span>
              </div>
              <div class="symbol-item" data-symbol="light-switch" draggable="true" title="Light Switch">
                <svg viewBox="0 0 40 40">
                  <rect x="10" y="8" width="20" height="24" fill="#f5f5f5" rx="2"/>
                  <rect x="12" y="10" width="16" height="20" fill="#e5e7eb"/>
                  <rect x="16" y="12" width="8" height="16" fill="#d1d5db" rx="1"/>
                  <rect x="17" y="13" width="6" height="7" fill="#9ca3af" rx="1"/>
                </svg>
                <span>Light Switch</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Canvas Container -->
    <div id="canvas-container">
      <div class="ruler-horizontal" id="ruler-horizontal"></div>
      <div class="canvas-with-rulers">
        <div class="ruler-corner" id="ruler-corner">in</div>
        <div class="ruler-vertical" id="ruler-vertical"></div>
        <div class="canvas-area" id="canvas-area">
          <div id="labels-container"></div>
          <div id="marquee-selection"></div>
        </div>
      </div>
    </div>

    <!-- Properties Panel -->
    <div id="properties-panel">
      <div class="resize-handle resize-handle-left" data-resize="properties-panel"></div>
      <div class="panel-section" id="selection-properties" style="display:none;">
        <h3>Selection</h3>
        <div class="property-row">
          <label>Type:</label>
          <span id="prop-type">-</span>
        </div>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Length:</label>
            <span id="prop-length-value">0"</span>
          </div>
          <input type="range" id="prop-length" min="12" max="480" value="120" class="slider">
        </div>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Height:</label>
            <span id="prop-height-value">96"</span>
          </div>
          <input type="range" id="prop-height" min="24" max="240" value="96" class="slider">
        </div>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Thickness:</label>
            <span id="prop-thickness-value">6"</span>
          </div>
          <input type="range" id="prop-thickness" min="2" max="24" value="6" class="slider">
        </div>
        <div style="margin-top: 12px;">
          <button id="btn-delete-selected" style="width: 100%;">Delete</button>
        </div>
      </div>

      <div class="panel-section" id="furniture-properties" style="display:none;">
        <h3>Furniture Properties</h3>
        <div class="property-row">
          <label>Type:</label>
          <span id="furn-type">-</span>
        </div>
        <div class="property-row">
          <label>Width:</label>
          <input type="number" id="furn-width" min="1" max="480" value="36" style="width: 60px;">
          <span style="font-size: 11px; color: var(--text-secondary);">in</span>
        </div>
        <div class="property-row">
          <label>Depth:</label>
          <input type="number" id="furn-depth" min="1" max="480" value="36" style="width: 60px;">
          <span style="font-size: 11px; color: var(--text-secondary);">in</span>
        </div>
        <div class="property-row">
          <label>Height:</label>
          <input type="number" id="furn-height" min="1" max="240" value="36" style="width: 60px;">
          <span style="font-size: 11px; color: var(--text-secondary);">in</span>
        </div>
        <div class="property-row">
          <label>Rotation:</label>
          <input type="number" id="furn-rotation" min="0" max="359" value="0" style="width: 60px;">
          <span style="font-size: 11px; color: var(--text-secondary);">deg</span>
        </div>
        <div style="margin-top: 12px;">
          <button id="btn-delete-furniture" style="width: 100%;">Delete</button>
        </div>
      </div>

      <div class="panel-section" id="wall-defaults">
        <h3>Wall Defaults</h3>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Height:</label>
            <span id="default-height-value">96"</span>
          </div>
          <input type="range" id="default-height" min="24" max="240" value="96" class="slider">
        </div>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Thickness:</label>
            <span id="default-thickness-value">6"</span>
          </div>
          <input type="range" id="default-thickness" min="2" max="24" value="6" class="slider">
        </div>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Simplify:</label>
            <span id="simplify-tolerance-value">8</span>
          </div>
          <input type="range" id="simplify-tolerance" min="2" max="30" value="8" class="slider">
        </div>
      </div>

      <div class="panel-section" id="image-settings" style="display:none;">
        <h3>Reference Image</h3>
        <div class="property-row" style="flex-direction: column; align-items: stretch;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
            <label>Opacity:</label>
            <span id="image-opacity-value">50%</span>
          </div>
          <input type="range" id="image-opacity" min="0" max="100" value="50" class="slider">
        </div>
        <div class="property-row" style="margin-top: 8px;">
          <button id="btn-remove-image" style="width: 100%; font-size: 11px;">Remove Image</button>
        </div>
      </div>

      <div class="panel-section">
        <h3>Layers</h3>
        <div class="layer-item" data-layer="walls">
          <input type="checkbox" id="layer-walls" checked>
          <span class="layer-color" style="background: var(--wall-color);"></span>
          <label for="layer-walls">Walls</label>
        </div>
        <div class="layer-item" data-layer="openings">
          <input type="checkbox" id="layer-openings" checked>
          <span class="layer-color" style="background: var(--opening-door);"></span>
          <label for="layer-openings">Openings</label>
        </div>
        <div class="layer-item" data-layer="furniture">
          <input type="checkbox" id="layer-furniture" checked>
          <span class="layer-color" style="background: var(--furniture-color);"></span>
          <label for="layer-furniture">Furniture</label>
        </div>
        <div class="layer-item" data-layer="dimensions">
          <input type="checkbox" id="layer-dimensions" checked>
          <span class="layer-color" style="background: var(--dimension-color);"></span>
          <label for="layer-dimensions">Dimensions</label>
        </div>
        <div class="layer-item" data-layer="annotations">
          <input type="checkbox" id="layer-annotations" checked>
          <span class="layer-color" style="background: #ff69b4;"></span>
          <label for="layer-annotations">Annotations</label>
        </div>
      </div>

      <div class="panel-section">
        <h3>Stats</h3>
        <div class="property-row">
          <label>Walls:</label>
          <span id="stat-walls">0</span>
        </div>
        <div class="property-row">
          <label>Openings:</label>
          <span id="stat-openings">0</span>
        </div>
        <div class="property-row">
          <label>Furniture:</label>
          <span id="stat-furniture">0</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Status Bar -->
  <div id="status-bar">
    <div class="status-group">
      <div class="status-item">
        <span>Mode:</span>
        <strong id="status-mode">Wall Drawing</strong>
      </div>
      <div class="status-item">
        <span>Length:</span>
        <strong id="status-length">-</strong>
      </div>
      <div class="status-item">
        <span>Mouse:</span>
        <strong id="status-mouse">0, 0</strong>
      </div>
    </div>
    <div class="status-group">
      <div class="unit-toggle">
        <label><input type="radio" name="unit" value="in" checked> in</label>
        <label><input type="radio" name="unit" value="cm"> cm</label>
      </div>
    </div>
  </div>

  <!-- Drag Preview -->
  <div id="drag-preview"></div>

  <!-- Help Tooltip -->
  <div class="help-tooltip" id="help-tooltip">
    <kbd>W</kbd> Wall (drag to draw, release to edit points, click to confirm) | <kbd>V</kbd> Select | <kbd>D</kbd> Dimension | <kbd>A</kbd> Annotate | <kbd>S</kbd> Shape | <kbd>Esc</kbd> Cancel | <kbd>Del</kbd> Delete
  </div>


  <!-- Three.js from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <!-- Application JavaScript -->
  <script type="module" src="./js/main.js"></script>
</body>
</html>
